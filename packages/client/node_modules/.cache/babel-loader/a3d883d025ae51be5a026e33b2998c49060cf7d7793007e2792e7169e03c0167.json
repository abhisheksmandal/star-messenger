{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useContext, useEffect } from \"react\";\nimport { AccountContext } from \"../AccountContext\";\nconst useSocketSetup = (setFriendList, setMessages, socket) => {\n  _s();\n  const {\n    setUser\n  } = useContext(AccountContext);\n  useEffect(() => {\n    socket.connect();\n    socket.on(\"friends\", friendList => {\n      setFriendList(friendList);\n    });\n    socket.on(\"messages\", messages => {\n      setMessages(messages);\n    });\n    socket.on(\"dm\", message => {\n      setMessages(prevMsgs => [message, ...prevMsgs]);\n    });\n    socket.on(\"connected\", (status, username) => {\n      setFriendList(prevFriends => {\n        return [...prevFriends].map(friend => {\n          if (friend.username === username) {\n            friend.connected = status;\n          }\n          return friend;\n        });\n      });\n    });\n    socket.on(\"connect_error\", () => {\n      setUser({\n        loggedIn: false\n      });\n    });\n    return () => {\n      socket.off(\"connect_error\");\n      socket.off(\"connected\");\n      socket.off(\"friends\");\n      socket.off(\"messages\");\n      socket.off(\"dm\");\n    };\n  }, [setUser, setFriendList, setMessages, socket]);\n};\n_s(useSocketSetup, \"8o46IJKbPuhjx3NMCbW3YYXw9mI=\");\nexport default useSocketSetup;","map":{"version":3,"names":["useContext","useEffect","AccountContext","useSocketSetup","setFriendList","setMessages","socket","_s","setUser","connect","on","friendList","messages","message","prevMsgs","status","username","prevFriends","map","friend","connected","loggedIn","off"],"sources":["/home/abhishek/Projects/star-messenger/packages/client/src/components/Home/useSocketSetup.jsx"],"sourcesContent":["import { useContext, useEffect } from \"react\";\nimport { AccountContext } from \"../AccountContext\";\n\nconst useSocketSetup = (setFriendList, setMessages, socket) => {\n  const { setUser } = useContext(AccountContext);\n  useEffect(() => {\n    socket.connect();\n    socket.on(\"friends\", (friendList) => {\n      setFriendList(friendList);\n    });\n    socket.on(\"messages\", (messages) => {\n      setMessages(messages);\n    });\n    socket.on(\"dm\", (message) => {\n      setMessages((prevMsgs) => [message, ...prevMsgs]);\n    });\n    socket.on(\"connected\", (status, username) => {\n      setFriendList((prevFriends) => {\n        return [...prevFriends].map((friend) => {\n          if (friend.username === username) {\n            friend.connected = status;\n          }\n          return friend;\n        });\n      });\n    });\n    socket.on(\"connect_error\", () => {\n      setUser({ loggedIn: false });\n    });\n    return () => {\n      socket.off(\"connect_error\");\n      socket.off(\"connected\");\n      socket.off(\"friends\");\n      socket.off(\"messages\");\n      socket.off(\"dm\");\n    };\n  }, [setUser, setFriendList, setMessages, socket]);\n};\n\nexport default useSocketSetup;\n"],"mappings":";AAAA,SAASA,UAAU,EAAEC,SAAS,QAAQ,OAAO;AAC7C,SAASC,cAAc,QAAQ,mBAAmB;AAElD,MAAMC,cAAc,GAAGA,CAACC,aAAa,EAAEC,WAAW,EAAEC,MAAM,KAAK;EAAAC,EAAA;EAC7D,MAAM;IAAEC;EAAQ,CAAC,GAAGR,UAAU,CAACE,cAAc,CAAC;EAC9CD,SAAS,CAAC,MAAM;IACdK,MAAM,CAACG,OAAO,CAAC,CAAC;IAChBH,MAAM,CAACI,EAAE,CAAC,SAAS,EAAGC,UAAU,IAAK;MACnCP,aAAa,CAACO,UAAU,CAAC;IAC3B,CAAC,CAAC;IACFL,MAAM,CAACI,EAAE,CAAC,UAAU,EAAGE,QAAQ,IAAK;MAClCP,WAAW,CAACO,QAAQ,CAAC;IACvB,CAAC,CAAC;IACFN,MAAM,CAACI,EAAE,CAAC,IAAI,EAAGG,OAAO,IAAK;MAC3BR,WAAW,CAAES,QAAQ,IAAK,CAACD,OAAO,EAAE,GAAGC,QAAQ,CAAC,CAAC;IACnD,CAAC,CAAC;IACFR,MAAM,CAACI,EAAE,CAAC,WAAW,EAAE,CAACK,MAAM,EAAEC,QAAQ,KAAK;MAC3CZ,aAAa,CAAEa,WAAW,IAAK;QAC7B,OAAO,CAAC,GAAGA,WAAW,CAAC,CAACC,GAAG,CAAEC,MAAM,IAAK;UACtC,IAAIA,MAAM,CAACH,QAAQ,KAAKA,QAAQ,EAAE;YAChCG,MAAM,CAACC,SAAS,GAAGL,MAAM;UAC3B;UACA,OAAOI,MAAM;QACf,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ,CAAC,CAAC;IACFb,MAAM,CAACI,EAAE,CAAC,eAAe,EAAE,MAAM;MAC/BF,OAAO,CAAC;QAAEa,QAAQ,EAAE;MAAM,CAAC,CAAC;IAC9B,CAAC,CAAC;IACF,OAAO,MAAM;MACXf,MAAM,CAACgB,GAAG,CAAC,eAAe,CAAC;MAC3BhB,MAAM,CAACgB,GAAG,CAAC,WAAW,CAAC;MACvBhB,MAAM,CAACgB,GAAG,CAAC,SAAS,CAAC;MACrBhB,MAAM,CAACgB,GAAG,CAAC,UAAU,CAAC;MACtBhB,MAAM,CAACgB,GAAG,CAAC,IAAI,CAAC;IAClB,CAAC;EACH,CAAC,EAAE,CAACd,OAAO,EAAEJ,aAAa,EAAEC,WAAW,EAAEC,MAAM,CAAC,CAAC;AACnD,CAAC;AAACC,EAAA,CAlCIJ,cAAc;AAoCpB,eAAeA,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}