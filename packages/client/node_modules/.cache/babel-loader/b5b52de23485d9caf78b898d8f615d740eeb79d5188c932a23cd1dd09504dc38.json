{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useContext, useEffect } from \"react\";\nimport socket from \"../../socket\";\nimport { AccountContext } from \"../AccountContext\";\nconst useSocketSetup = (setFriendList, setMessages) => {\n  _s();\n  const {\n    setUser\n  } = useContext(AccountContext);\n  useEffect(() => {\n    console.log(\"Setting up socket\");\n    socket.connect();\n    socket.on(\"friends\", friendList => {\n      console.log(\"Received friends:\", friendList);\n      setFriendList(friendList);\n    });\n    socket.on(\"messages\", messages => {\n      setMessages(messages);\n    });\n    socket.on(\"connected\", (status, username) => {\n      console.log(`Received connected event: status=${status}, username=${username}`);\n      setFriendList(prevFriend => {\n        return prevFriend.map(friend => {\n          if (friend && friend.username === username) {\n            return {\n              ...friend,\n              connected: status\n            };\n          }\n          return friend;\n        });\n      });\n    });\n    socket.on(\"connect_error\", () => {\n      console.log(\"Socket connection error\");\n      setUser({\n        loggedIn: false\n      });\n    });\n    return () => {\n      console.log(\"Cleaning up socket setup\");\n      socket.off(\"connect_error\");\n      socket.off(\"connected\");\n      socket.off(\"friends\");\n      socket.off(\"messages\");\n    };\n  }, [setUser, setFriendList, setMessages]);\n};\n_s(useSocketSetup, \"8o46IJKbPuhjx3NMCbW3YYXw9mI=\");\nexport default useSocketSetup;","map":{"version":3,"names":["useContext","useEffect","socket","AccountContext","useSocketSetup","setFriendList","setMessages","_s","setUser","console","log","connect","on","friendList","messages","status","username","prevFriend","map","friend","connected","loggedIn","off"],"sources":["/home/abhishek/Projects/star-messenger/packages/client/src/components/Home/useSocketSetup.jsx"],"sourcesContent":["import { useContext, useEffect } from \"react\";\nimport socket from \"../../socket\";\nimport { AccountContext } from \"../AccountContext\";\n\nconst useSocketSetup = (setFriendList, setMessages) => {\n  const { setUser } = useContext(AccountContext);\n\n  useEffect(() => {\n    console.log(\"Setting up socket\");\n\n    socket.connect();\n\n    socket.on(\"friends\", (friendList) => {\n      console.log(\"Received friends:\", friendList);\n      setFriendList(friendList);\n    });\n    socket.on(\"messages\", (messages) => {\n      setMessages(messages);\n    });\n\n    socket.on(\"connected\", (status, username) => {\n      console.log(\n        `Received connected event: status=${status}, username=${username}`\n      );\n      setFriendList((prevFriend) => {\n        return prevFriend.map((friend) => {\n          if (friend && friend.username === username) {\n            return { ...friend, connected: status };\n          }\n          return friend;\n        });\n      });\n    });\n\n    socket.on(\"connect_error\", () => {\n      console.log(\"Socket connection error\");\n      setUser({ loggedIn: false });\n    });\n\n    return () => {\n      console.log(\"Cleaning up socket setup\");\n      socket.off(\"connect_error\");\n      socket.off(\"connected\");\n      socket.off(\"friends\");\n      socket.off(\"messages\");\n    };\n  }, [setUser, setFriendList, setMessages]);\n};\n\nexport default useSocketSetup;\n"],"mappings":";AAAA,SAASA,UAAU,EAAEC,SAAS,QAAQ,OAAO;AAC7C,OAAOC,MAAM,MAAM,cAAc;AACjC,SAASC,cAAc,QAAQ,mBAAmB;AAElD,MAAMC,cAAc,GAAGA,CAACC,aAAa,EAAEC,WAAW,KAAK;EAAAC,EAAA;EACrD,MAAM;IAAEC;EAAQ,CAAC,GAAGR,UAAU,CAACG,cAAc,CAAC;EAE9CF,SAAS,CAAC,MAAM;IACdQ,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC;IAEhCR,MAAM,CAACS,OAAO,CAAC,CAAC;IAEhBT,MAAM,CAACU,EAAE,CAAC,SAAS,EAAGC,UAAU,IAAK;MACnCJ,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEG,UAAU,CAAC;MAC5CR,aAAa,CAACQ,UAAU,CAAC;IAC3B,CAAC,CAAC;IACFX,MAAM,CAACU,EAAE,CAAC,UAAU,EAAGE,QAAQ,IAAK;MAClCR,WAAW,CAACQ,QAAQ,CAAC;IACvB,CAAC,CAAC;IAEFZ,MAAM,CAACU,EAAE,CAAC,WAAW,EAAE,CAACG,MAAM,EAAEC,QAAQ,KAAK;MAC3CP,OAAO,CAACC,GAAG,CACR,oCAAmCK,MAAO,cAAaC,QAAS,EACnE,CAAC;MACDX,aAAa,CAAEY,UAAU,IAAK;QAC5B,OAAOA,UAAU,CAACC,GAAG,CAAEC,MAAM,IAAK;UAChC,IAAIA,MAAM,IAAIA,MAAM,CAACH,QAAQ,KAAKA,QAAQ,EAAE;YAC1C,OAAO;cAAE,GAAGG,MAAM;cAAEC,SAAS,EAAEL;YAAO,CAAC;UACzC;UACA,OAAOI,MAAM;QACf,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ,CAAC,CAAC;IAEFjB,MAAM,CAACU,EAAE,CAAC,eAAe,EAAE,MAAM;MAC/BH,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAC;MACtCF,OAAO,CAAC;QAAEa,QAAQ,EAAE;MAAM,CAAC,CAAC;IAC9B,CAAC,CAAC;IAEF,OAAO,MAAM;MACXZ,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAC;MACvCR,MAAM,CAACoB,GAAG,CAAC,eAAe,CAAC;MAC3BpB,MAAM,CAACoB,GAAG,CAAC,WAAW,CAAC;MACvBpB,MAAM,CAACoB,GAAG,CAAC,SAAS,CAAC;MACrBpB,MAAM,CAACoB,GAAG,CAAC,UAAU,CAAC;IACxB,CAAC;EACH,CAAC,EAAE,CAACd,OAAO,EAAEH,aAAa,EAAEC,WAAW,CAAC,CAAC;AAC3C,CAAC;AAACC,EAAA,CA3CIH,cAAc;AA6CpB,eAAeA,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}